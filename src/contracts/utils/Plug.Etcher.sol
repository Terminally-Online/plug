// SPDX-License-Identifier: MIT

pragma solidity 0.8.23;

import { PlugRouterSocket } from "../sockets/Plug.Router.Socket.sol";
import { PlugVaultSocket } from "../sockets/Plug.Vault.Socket.sol";

/**
 * @title Plug Etcher
 * @notice This contract is the basis of the automatically generated Plug Etcher
 *         contract used to deploy and write the proper addresses. If you need to add
 *         a new etch into the vm stack for testing, you will do so through the file
 *         found at: /lib/functions/etcher.ts
 * @notice A good portion of this model comes from:
 *         https://github.com/Vectorized/multicaller/blob/main/src/MulticallerEtcher.sol
 *         I am not a Foundry expert. If there is a better way to do this, please let me
 *         know because this is a lot of work just to get a contract deployed when you're
 *         doing anything more than a simple in-and-out contract.
 * @author vectorized (twitter:@optimizoor)
 */
contract PlugEtcher {
    bytes internal constant ROUTER_SOCKET_INITCODE =
        hex"60806040523480156200001157600080fd5b506200001e600162000024565b62000231565b63409feecd1980546003825580156200005d5760018160011c14303b10620000545763f92ee8a96000526004601cfd5b818160ff1b1b91505b506200006982620000f7565b620000bd6200009b60408051808201909152601081526f141b1d59d49bdd5d195c94dbd8dad95d60821b602082015290565b6040805180820190915260058152640302e302e360dc1b602082015262000152565b8015620000f3576002815560016020527fc7f505b2f371ae2175ee4913f4499e1f2633a7b5936321eed1cdaeb6115181d2602080a15b5050565b638b78c6d8198054156200011357630dc149f06000526004601cfd5b6001600160a01b03909116801560ff1b81179091558060007f8be0079c531659141344cd1fd0a4f28419497f9722a3daafe3b4186f6b6457e08180a350565b6200018c6040518060800160405280848152602001838152602001468152602001306001600160a01b03168152506200019360201b60201c565b6000555050565b60007f8b73c3c69bb8fe3d512ecc4cf759cc79239f7b179b0ffacaa9a75d522b39400f82600001518051906020012083602001518051906020012084604001518560600151604051602001620002149594939291909485526020850193909352604084019190915260608301526001600160a01b0316608082015260a00190565b604051602081830303815290604052805190602001209050919050565b612c7980620002416000396000f3fe60806040526004361061021d5760003560e01c8063757bc36a1161011d578063cfd8e4f2116100b0578063f04e283e1161007f578063f51e4d5d11610064578063f51e4d5d146106ab578063fee81cf4146106be578063ff38a175146106f157610224565b8063f04e283e14610685578063f2fde38b1461069857610224565b8063cfd8e4f2146105f7578063dfe86ac514610617578063e55bd45b1461062d578063e8b1a9b21461064d57610224565b80639760ca3b116100ec5780639760ca3b1461056a578063bab253b314610597578063c3dbb7ad146105c4578063c4d66de8146105e457610224565b8063757bc36a146104d65780638138d3c5146104f65780638175cccf146105165780638da5cb5b1461053657610224565b8063484ac061116101b05780635b9459991161017f5780635f5ff29d116101645780635f5ff29d14610480578063715018a6146104a057806373eabec5146104a857610224565b80635b945999146104405780635d7bd8501461046057610224565b8063484ac061146103b2578063541a6049146103d257806354d1f13d146103f257806354fd4d50146103fa57610224565b806334bb3700116101ec57806334bb370014610300578063400571ba14610320578063450e94e91461037257806345df31421461039257610224565b806306fdde031461025257806319cac942146102aa57806325692962146102d857806329301c48146102e057610224565b3661022457005b60003560e01c63bc197c81811463f23a6e6182141763150b7a028214171561025057806020526020603cf35b005b34801561025e57600080fd5b5060408051808201909152601081527f506c7567526f75746572536f636b65740000000000000000000000000000000060208201525b6040516102a19190611d87565b60405180910390f35b3480156102b657600080fd5b506102ca6102c5366004612039565b610711565b6040519081526020016102a1565b610250610786565b3480156102ec57600080fd5b506102ca6102fb3660046123d0565b6107d6565b34801561030c57600080fd5b506102ca61031b366004612405565b61083a565b34801561032c57600080fd5b5060025461034d9073ffffffffffffffffffffffffffffffffffffffff1681565b60405173ffffffffffffffffffffffffffffffffffffffff90911681526020016102a1565b34801561037e57600080fd5b506102ca61038d3660046124b1565b6108c7565b34801561039e57600080fd5b506102ca6103ad3660046124e6565b610939565b3480156103be57600080fd5b506102ca6103cd366004612502565b610986565b3480156103de57600080fd5b506102ca6103ed366004612502565b61098f565b610250610a1e565b34801561040657600080fd5b5060408051808201909152600581527f302e302e300000000000000000000000000000000000000000000000000000006020820152610294565b34801561044c57600080fd5b5061034d61045b366004612537565b610a5a565b34801561046c57600080fd5b506102ca61047b366004612537565b610a7d565b34801561048c57600080fd5b506102ca61049b36600461256c565b610ad9565b610250610b3e565b3480156104b457600080fd5b506104c86104c33660046125a1565b610b52565b6040516102a192919061262f565b3480156104e257600080fd5b506102ca6104f1366004612654565b610c8e565b34801561050257600080fd5b506102ca610511366004612689565b610cf6565b34801561052257600080fd5b506102ca6105313660046126be565b610d5b565b34801561054257600080fd5b507fffffffffffffffffffffffffffffffffffffffffffffffffffffffff748739275461034d565b34801561057657600080fd5b5061058a6105853660046126f3565b610dcd565b6040516102a19190612768565b3480156105a357600080fd5b5060015461034d9073ffffffffffffffffffffffffffffffffffffffff1681565b3480156105d057600080fd5b506102ca6105df36600461282a565b61100a565b6102506105f236600461285f565b61103a565b61060a61060536600461287a565b611145565b6040516102a191906128b5565b34801561062357600080fd5b506102ca60005481565b34801561063957600080fd5b506102ca6106483660046123d0565b6111a1565b34801561065957600080fd5b506102ca61066836600461292a565b600360209081526000928352604080842090915290825290205481565b61025061069336600461285f565b6111fd565b6102506106a636600461285f565b61123d565b61060a6106b93660046126f3565b611264565b3480156106ca57600080fd5b506102ca6106d936600461285f565b63389a75e1600c908152600091909152602090205490565b3480156106fd57600080fd5b5061034d61070c36600461282a565b611271565b60006060600080845190505b80821015610776578261074886848151811061073b5761073b612954565b6020026020010151610d5b565b604051602001610759929190612983565b60408051601f19818403018152919052925060019091019061071d565b5050805160209091012092915050565b60006202a30067ffffffffffffffff164201905063389a75e1600c5233600052806020600c2055337fdbf36a107da19e49527a7176a1babf963b4b0ff8cde35ee35d6cd8f1f9ac7e1d600080a250565b600080546107e3836111a1565b6040517f19010000000000000000000000000000000000000000000000000000000000006020820152602281019290925260428201526062015b604051602081830303815290604052805190602001209050919050565b60007f8b73c3c69bb8fe3d512ecc4cf759cc79239f7b179b0ffacaa9a75d522b39400f8260000151805190602001208360200151805190602001208460400151856060015160405160200161081d95949392919094855260208501939093526040840191909152606083015273ffffffffffffffffffffffffffffffffffffffff16608082015260a00190565b805160208083015160408085015180519084012081517fba015bd32610c44647c4bcbb8c645ee60d5957ae5e7aa37e56c897d9295af65a9481019490945273ffffffffffffffffffffffffffffffffffffffff909416908301526060820152608081019190915260009060a00161081d565b805160208083015160405160009361081d937f276c12ec467e6d60d25741105b112102c28092173b15ca9db916c654ad913d7c939192019283526020830191909152604082015260600190565b600080546107e3835b60007febe783112b2088c6a788530144d3c69021fe5d4d46f650940d6bfaf88b54e3f7826000015183602001516109c98560400151610711565b60608087015160808089015160408051602081019990995273ffffffffffffffffffffffffffffffffffffffff909716968801969096529186019390935284015260a0830152151560c082015260e00161081d565b63389a75e1600c523360005260006020600c2055337ffa7b8eab7da67f412cc9575ed43464468f9bfbae89d1675917346ca6d8fe3c92600080a2565b6000610a778260200151610a718460000151610986565b90611288565b92915050565b60007ffbb5bac87a66a98421e535854c88c14ea8206480ff93a62baef88eb379697455610aad836000015161098f565b60208085015180519082012060405161081d949392019283526020830191909152604082015260600190565b60006060600080845190505b808210156107765782610b10868481518110610b0357610b03612954565b6020026020010151610a7d565b604051602001610b21929190612983565b60408051601f198184030181529190529250600190910190610ae5565b610b46611332565b610b506000611368565b565b60408051808201909152600081526060602082018190529082516020840151855160405160009373ffffffffffffffffffffffffffffffffffffffff16927f11aecce20000000000000000000000000000000000000000000000000000000092610bc0928b906024016129a5565b60408051601f198184030181529181526020820180517bffffffffffffffffffffffffffffffffffffffffffffffffffffffff167fffffffff00000000000000000000000000000000000000000000000000000000909416939093179092529051610c2b9190612a0f565b600060405180830381855afa9150503d8060008114610c66576040519150601f19603f3d011682016040523d82523d6000602084013e610c6b565b606091505b506040805180820190915291151582526020820181905297909650945050505050565b60007fd88a558de6e76ae3b06e4691e5c7eb27632ad144c564c3c807b9b011d3207c89610cbe83600001516108c7565b610ccb8460200151610ad9565b604080860151815160208101959095529084019290925260608301521515608082015260a00161081d565b60006060600080845190505b808210156107765782610d2d868481518110610d2057610d20612954565b6020026020010151610c8e565b604051602001610d3e929190612983565b60408051601f198184030181529190529250600190910190610d02565b805160208083015180519082012060408085015181517f11d2e7ce7b01636231a80046eb2467257c3ea77c5a408e6ddd3d0899cfbc73799481019490945273ffffffffffffffffffffffffffffffffffffffff909416908301526060820152901515608082015260009060a00161081d565b6060816000819003610e20576040805160008082526020820190925290610e17565b604080518082019091526000815260606020820152815260200190600190039081610def5790505b50915050610a77565b60008167ffffffffffffffff811115610e3b57610e3b611d9a565b604051908082528060200260200182016040528015610e8157816020015b604080518082019091526000815260606020820152815260200190600190039081610e595790505b50905060005b60ff811685111561100157600086868360ff16818110610ea957610ea9612954565b9050602002810190610ebb9190612a2b565b610ec490612a5f565b9050806020015151600003610ed95750610fef565b60005b8160200151518160ff161015610fec57600082602001518260ff1681518110610f0757610f07612954565b6020026020010151600001519050806040015151600003610f285750610fda565b6000610f4684602001518460ff1681518110610b0357610b03612954565b905060005b8260400151518160ff161015610fd657610f86828685604001518460ff1681518110610f7957610f79612954565b6020026020010151610b52565b86516040018b8b610f9681612a9a565b9c508b51610fa49190612acf565b81518110610fb457610fb4612954565b6020026020010182905282905250508080610fce90612ae2565b915050610f4b565b5050505b80610fe481612ae2565b915050610edc565b50505b80610ff981612ae2565b915050610e87565b50505092915050565b60007f62f30595f4177d43243112a959ea1be53d5882871b1cc6917311b8d1fe83793c610aad83600001516111a1565b7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffbf601132805460038255801561108c5760018160011c14303b106110835763f92ee8a96000526004601cfd5b818160ff1b1b91505b50611096826113d7565b61110c6110d360408051808201909152601081527f506c7567526f75746572536f636b657400000000000000000000000000000000602082015290565b60408051808201909152600581527f302e302e300000000000000000000000000000000000000000000000000000006020820152611459565b8015611141576002815560016020527fc7f505b2f371ae2175ee4913f4499e1f2633a7b5936321eed1cdaeb6115181d2602080a15b5050565b6060600061115561070c84612b01565b905061117d816111658580612a2b565b60200180360381019061117891906124e6565b61149f565b61119a61118a8480612a2b565b6111949080612b0d565b83611553565b9392505050565b60007f47c7cdc8df0e6a9774c8b8955db068ee1707012a385dae083e0190f51ab2f4e56111d18360000151610cf6565b6111de8460200151610939565b604080516020810194909452830191909152606082015260800161081d565b611205611332565b63389a75e1600c52806000526020600c20805442111561122d57636f5e88186000526004601cfd5b6000905561123a81611368565b50565b611245611332565b8060601b61125b57637448fbae6000526004601cfd5b61123a81611368565b606061119a838333611553565b6000610a778260200151610a7184600001516107d6565b60405160019083600052602083015160405260408351036112dd57604083015160ff81901c601b016020527f7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff16606052611303565b60418351036112fe57606083015160001a6020526040830151606052611303565b600091505b6020600160806000855afa5191503d61132457638baa579f6000526004601cfd5b600060605260405292915050565b7fffffffffffffffffffffffffffffffffffffffffffffffffffffffff74873927543314610b50576382b429006000526004601cfd5b7fffffffffffffffffffffffffffffffffffffffffffffffffffffffff74873927805473ffffffffffffffffffffffffffffffffffffffff9092169182907f8be0079c531659141344cd1fd0a4f28419497f9722a3daafe3b4186f6b6457e0600080a3811560ff1b8217905550565b7fffffffffffffffffffffffffffffffffffffffffffffffffffffffff7487392780541561140d57630dc149f06000526004601cfd5b73ffffffffffffffffffffffffffffffffffffffff909116801560ff1b81179091558060007f8be0079c531659141344cd1fd0a4f28419497f9722a3daafe3b4186f6b6457e08180a350565b61149860405180608001604052808481526020018381526020014681526020013073ffffffffffffffffffffffffffffffffffffffff1681525061083a565b6000555050565b73ffffffffffffffffffffffffffffffffffffffff82166000908152600360209081526040808320848301518452909152812080549091906114e090612b7c565b9182905550815114611141576040517f08c379a000000000000000000000000000000000000000000000000000000000815260206004820152601c60248201527f506c7567436f72653a6e6f6e6365322d6f75742d6f662d6f726465720000000060448201526064015b60405180910390fd5b60608267ffffffffffffffff81111561156e5761156e611d9a565b6040519080825280602002602001820160405280156115a157816020015b606081526020019060019003908161158c5790505b50905060008060008060006115e26040805160c081018252600060608083018281526080840183905260a08401829052835260208301529181019190915290565b6040805160e08101825260008183018181526060808401839052608080850182905260a080860185905260c086018590529285526020808601839052865193840187528484528301849052948201819052810182905292830152905b8a8810156119f3578b8b8981811061165857611658612954565b905060200281019061166a9190612a2b565b61167390612a5f565b6020810151516000955090935084036116db576002805473ffffffffffffffffffffffffffffffffffffffff8c167fffffffffffffffffffffffff000000000000000000000000000000000000000091821681179092556001805490911690911790556118f0565b600096505b8260200151518710156118f0578260200151878151811061170357611703612954565b6020026020010151915061171682610a5a565b945086600003611771576002805473ffffffffffffffffffffffffffffffffffffffff87167fffffffffffffffffffffffff000000000000000000000000000000000000000091821681179092556001805490911690911790555b60015473ffffffffffffffffffffffffffffffffffffffff8681169116146117f5576040517f08c379a000000000000000000000000000000000000000000000000000000000815260206004820152601b60248201527f506c7567436f72653a696e76616c69642d70696e2d7369676e65720000000000604482015260640161154a565b5080516020810151841461188b576040517f08c379a000000000000000000000000000000000000000000000000000000000815260206004820152602360248201527f506c7567436f72653a696e76616c69642d617574686f726974792d70696e2d6c60448201527f696e6b0000000000000000000000000000000000000000000000000000000000606482015260840161154a565b61189482610a7d565b9350600095505b8060400151518610156118e5576118d4816040015187815181106118c1576118c1612954565b6020026020010151846000015186611a02565b83516040015260019095019461189b565b6001909601956116e0565b60015473ffffffffffffffffffffffffffffffffffffffff8b8116911614611974576040517f08c379a000000000000000000000000000000000000000000000000000000000815260206004820152601760248201527f506c7567436f72653a696e76616c69642d73656e646572000000000000000000604482015260640161154a565b8251600254611999919073ffffffffffffffffffffffffffffffffffffffff16611b2e565b8989815181106119ab576119ab612954565b6020908102919091010152600180547fffffffffffffffffffffffff00000000000000000000000000000000000000009081168255600280549091169055979097019661163e565b50505050505050509392505050565b60606000846000015173ffffffffffffffffffffffffffffffffffffffff166311aecce260e01b86602001518686604051602401611a42939291906129a5565b60408051601f198184030181529181526020820180517bffffffffffffffffffffffffffffffffffffffffffffffffffffffff167fffffffff00000000000000000000000000000000000000000000000000000000909416939093179092529051611aad9190612a0f565b6000604051808303816000865af19150503d8060008114611aea576040519150601f19603f3d011682016040523d82523d6000602084013e611aef565b606091505b509250905080158015611b03575084604001515b15611b1157611b1182611be9565b81806020019051810190611b259190612bb4565b95945050505050565b60606000836040015183604051602001611b49929190612c22565b60405160208183030381529060405290506000846000015173ffffffffffffffffffffffffffffffffffffffff165a866020015184604051611b8b9190612a0f565b600060405180830381858888f193505050503d8060008114611bc9576040519150601f19603f3d011682016040523d82523d6000602084013e611bce565b606091505b509350905080611be157611be183611be9565b505092915050565b600481511015611c55576040517f08c379a000000000000000000000000000000000000000000000000000000000815260206004820152600f60248201527f506c7567436f72653a7265766572740000000000000000000000000000000000604482015260640161154a565b60208101517fb1b7848f000000000000000000000000000000000000000000000000000000007fffffffff00000000000000000000000000000000000000000000000000000000821601611d2e57604080518082018252601b81527f506c7567436f72653a7461726765742d70616e69636b65642d30780000000000602082018181526024860151600481811c600f908116603090810160081b918416011790931790915292517f08c379a000000000000000000000000000000000000000000000000000000000815291929161154a91849101611d87565b81518060208401fd5b60005b83811015611d52578181015183820152602001611d3a565b50506000910152565b60008151808452611d73816020860160208601611d37565b601f01601f19169290920160200192915050565b60208152600061119a6020830184611d5b565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052604160045260246000fd5b6040516060810167ffffffffffffffff81118282101715611dec57611dec611d9a565b60405290565b6040805190810167ffffffffffffffff81118282101715611dec57611dec611d9a565b6040516080810167ffffffffffffffff81118282101715611dec57611dec611d9a565b604051601f8201601f1916810167ffffffffffffffff81118282101715611e6157611e61611d9a565b604052919050565b600067ffffffffffffffff821115611e8357611e83611d9a565b5060051b60200190565b803573ffffffffffffffffffffffffffffffffffffffff81168114611eb157600080fd5b919050565b600067ffffffffffffffff821115611ed057611ed0611d9a565b50601f01601f191660200190565b600082601f830112611eef57600080fd5b8135611f02611efd82611eb6565b611e38565b818152846020838601011115611f1757600080fd5b816020850160208301376000918101602001919091529392505050565b80358015158114611eb157600080fd5b600060608284031215611f5657600080fd5b611f5e611dc9565b9050611f6982611e8d565b8152602082013567ffffffffffffffff811115611f8557600080fd5b611f9184828501611ede565b602083015250611fa360408301611f34565b604082015292915050565b600082601f830112611fbf57600080fd5b81356020611fcf611efd83611e69565b82815260059290921b84018101918181019086841115611fee57600080fd5b8286015b8481101561202e57803567ffffffffffffffff8111156120125760008081fd5b6120208986838b0101611f44565b845250918301918301611ff2565b509695505050505050565b60006020828403121561204b57600080fd5b813567ffffffffffffffff81111561206257600080fd5b61206e84828501611fae565b949350505050565b60006060828403121561208857600080fd5b612090611dc9565b905061209b82611e8d565b815260208201356020820152604082013567ffffffffffffffff8111156120c157600080fd5b6120cd84828501611ede565b60408301525092915050565b600060a082840312156120eb57600080fd5b60405160a0810167ffffffffffffffff828210818311171561210f5761210f611d9a565b8160405282935061211f85611e8d565b835260208501356020840152604085013591508082111561213f57600080fd5b5061214c85828601611fae565b6040830152506060830135606082015261216860808401611f34565b60808201525092915050565b60006040828403121561218657600080fd5b61218e611df2565b9050813567ffffffffffffffff808211156121a857600080fd5b6121b4858386016120d9565b835260208401359150808211156121ca57600080fd5b506121d784828501611ede565b60208301525092915050565b600082601f8301126121f457600080fd5b81356020612204611efd83611e69565b82815260059290921b8401810191818101908684111561222357600080fd5b8286015b8481101561202e57803567ffffffffffffffff8111156122475760008081fd5b6122558986838b0101612174565b845250918301918301612227565b60006060828403121561227557600080fd5b61227d611dc9565b9050813567ffffffffffffffff8082111561229757600080fd5b6122a385838601612076565b835260208401359150808211156122b957600080fd5b50611f91848285016121e3565b600082601f8301126122d757600080fd5b813560206122e7611efd83611e69565b82815260059290921b8401810191818101908684111561230657600080fd5b8286015b8481101561202e57803567ffffffffffffffff81111561232a5760008081fd5b6123388986838b0101612263565b84525091830191830161230a565b60006040828403121561235857600080fd5b612360611df2565b9050813581526020820135602082015292915050565b60006060828403121561238857600080fd5b612390611df2565b9050813567ffffffffffffffff8111156123a957600080fd5b6123b5848285016122c6565b8252506123c58360208401612346565b602082015292915050565b6000602082840312156123e257600080fd5b813567ffffffffffffffff8111156123f957600080fd5b61206e84828501612376565b60006020828403121561241757600080fd5b813567ffffffffffffffff8082111561242f57600080fd5b908301906080828603121561244357600080fd5b61244b611e15565b82358281111561245a57600080fd5b61246687828601611ede565b82525060208301358281111561247b57600080fd5b61248787828601611ede565b602083015250604083013560408201526124a360608401611e8d565b606082015295945050505050565b6000602082840312156124c357600080fd5b813567ffffffffffffffff8111156124da57600080fd5b61206e84828501612076565b6000604082840312156124f857600080fd5b61119a8383612346565b60006020828403121561251457600080fd5b813567ffffffffffffffff81111561252b57600080fd5b61206e848285016120d9565b60006020828403121561254957600080fd5b813567ffffffffffffffff81111561256057600080fd5b61206e84828501612174565b60006020828403121561257e57600080fd5b813567ffffffffffffffff81111561259557600080fd5b61206e848285016121e3565b6000806000606084860312156125b657600080fd5b83359250602084013567ffffffffffffffff808211156125d557600080fd5b6125e187838801612263565b935060408601359150808211156125f757600080fd5b5061260486828701611f44565b9150509250925092565b805115158252600060208201516040602085015261206e6040850182611d5b565b6040815260006126426040830185611d5b565b8281036020840152611b25818561260e565b60006020828403121561266657600080fd5b813567ffffffffffffffff81111561267d57600080fd5b61206e84828501612263565b60006020828403121561269b57600080fd5b813567ffffffffffffffff8111156126b257600080fd5b61206e848285016122c6565b6000602082840312156126d057600080fd5b813567ffffffffffffffff8111156126e757600080fd5b61206e84828501611f44565b6000806020838503121561270657600080fd5b823567ffffffffffffffff8082111561271e57600080fd5b818501915085601f83011261273257600080fd5b81358181111561274157600080fd5b8660208260051b850101111561275657600080fd5b60209290920196919550909350505050565b600060208083016020845280855180835260408601915060408160051b87010192506020870160005b828110156127dd577fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffc08886030184526127cb85835161260e565b94509285019290850190600101612791565b5092979650505050505050565b6000604082840312156127fc57600080fd5b612804611df2565b9050813567ffffffffffffffff8082111561281e57600080fd5b6121b485838601612376565b60006020828403121561283c57600080fd5b813567ffffffffffffffff81111561285357600080fd5b61206e848285016127ea565b60006020828403121561287157600080fd5b61119a82611e8d565b60006020828403121561288c57600080fd5b813567ffffffffffffffff8111156128a357600080fd5b82016040818503121561119a57600080fd5b600060208083016020845280855180835260408601915060408160051b87010192506020870160005b828110156127dd577fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffc0888603018452612918858351611d5b565b945092850192908501906001016128de565b6000806040838503121561293d57600080fd5b61294683611e8d565b946020939093013593505050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052603260045260246000fd5b60008351612995818460208801611d37565b9190910191825250602001919050565b6060815260006129b86060830186611d5b565b828103602084015273ffffffffffffffffffffffffffffffffffffffff8551168152602085015160208201526040850151606060408301526129fd6060830182611d5b565b92505050826040830152949350505050565b60008251612a21818460208701611d37565b9190910192915050565b600082357fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffa1833603018112612a2157600080fd5b6000610a773683612263565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052601160045260246000fd5b600081612aa957612aa9612a6b565b507fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0190565b81810381811115610a7757610a77612a6b565b600060ff821660ff8103612af857612af8612a6b565b60010192915050565b6000610a7736836127ea565b60008083357fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffe1843603018112612b4257600080fd5b83018035915067ffffffffffffffff821115612b5d57600080fd5b6020019150600581901b3603821315612b7557600080fd5b9250929050565b60007fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff8203612bad57612bad612a6b565b5060010190565b600060208284031215612bc657600080fd5b815167ffffffffffffffff811115612bdd57600080fd5b8201601f81018413612bee57600080fd5b8051612bfc611efd82611eb6565b818152856020838501011115612c1157600080fd5b611b25826020830160208601611d37565b60008351612c34818460208801611d37565b60609390931b7fffffffffffffffffffffffffffffffffffffffff00000000000000000000000016919092019081526014019291505056fea164736f6c6343000817000a";

    bytes32 internal constant ROUTER_SOCKET_SALT = 0x0;

    address internal constant ROUTER_SOCKET_ADDRESS = address(0);

    bytes internal constant VAULT_SOCKET_INITCODE =
        hex"60806040523480156200001157600080fd5b506200001e600162000024565b62000230565b63409feecd1980546003825580156200005d5760018160011c14303b10620000545763f92ee8a96000526004601cfd5b818160ff1b1b91505b506200006982620000f6565b620000bc6200009a60408051808201909152600f81526e141b1d59d5985d5b1d14dbd8dad95d608a1b602082015290565b6040805180820190915260058152640302e302e360dc1b602082015262000151565b8015620000f2576002815560016020527fc7f505b2f371ae2175ee4913f4499e1f2633a7b5936321eed1cdaeb6115181d2602080a15b5050565b638b78c6d8198054156200011257630dc149f06000526004601cfd5b6001600160a01b03909116801560ff1b81179091558060007f8be0079c531659141344cd1fd0a4f28419497f9722a3daafe3b4186f6b6457e08180a350565b6200018b6040518060800160405280848152602001838152602001468152602001306001600160a01b03168152506200019260201b60201c565b6000555050565b60007f8b73c3c69bb8fe3d512ecc4cf759cc79239f7b179b0ffacaa9a75d522b39400f82600001518051906020012083602001518051906020012084604001518560600151604051602001620002139594939291909485526020850193909352604084019190915260608301526001600160a01b0316608082015260a00190565b604051602081830303815290604052805190602001209050919050565b612e6180620002406000396000f3fe6080604052600436106102535760003560e01c806377fc285611610138578063cfd8e4f2116100b0578063f04e283e1161007f578063f51e4d5d11610064578063f51e4d5d14610731578063fee81cf414610744578063ff38a175146107775761025a565b8063f04e283e1461070b578063f2fde38b1461071e5761025a565b8063cfd8e4f21461067d578063dfe86ac51461069d578063e55bd45b146106b3578063e8b1a9b2146106d35761025a565b80638da5cb5b11610107578063bab253b3116100ec578063bab253b31461061d578063c3dbb7ad1461064a578063c4d66de81461066a5761025a565b80638da5cb5b146105bc5780639760ca3b146105f05761025a565b806377fc28561461052c5780637df73e271461055c5780638138d3c51461057c5780638175cccf1461059c5761025a565b8063541a6049116101cb5780635d7bd8501161019a578063715018a61161017f578063715018a6146104d657806373eabec5146104de578063757bc36a1461050c5761025a565b80635d7bd850146104965780635f5ff29d146104b65761025a565b8063541a60491461040857806354d1f13d1461042857806354fd4d50146104305780635b945999146104765761025a565b806334bb370011610222578063450e94e911610207578063450e94e9146103a857806345df3142146103c8578063484ac061146103e85761025a565b806334bb370014610336578063400571ba146103565761025a565b806306fdde031461028857806319cac942146102e0578063256929621461030e57806329301c48146103165761025a565b3661025a57005b60003560e01c63bc197c81811463f23a6e6182141763150b7a028214171561028657806020526020603cf35b005b34801561029457600080fd5b5060408051808201909152600f81527f506c75675661756c74536f636b6574000000000000000000000000000000000060208201525b6040516102d79190611f6f565b60405180910390f35b3480156102ec57600080fd5b506103006102fb366004612221565b610797565b6040519081526020016102d7565b61028661080c565b34801561032257600080fd5b506103006103313660046125b8565b61085c565b34801561034257600080fd5b506103006103513660046125ed565b6108c0565b34801561036257600080fd5b506002546103839073ffffffffffffffffffffffffffffffffffffffff1681565b60405173ffffffffffffffffffffffffffffffffffffffff90911681526020016102d7565b3480156103b457600080fd5b506103006103c3366004612699565b61094d565b3480156103d457600080fd5b506103006103e33660046126ce565b6109bf565b3480156103f457600080fd5b506103006104033660046126ea565b610a0c565b34801561041457600080fd5b506103006104233660046126ea565b610a15565b610286610aa4565b34801561043c57600080fd5b5060408051808201909152600581527f302e302e3000000000000000000000000000000000000000000000000000000060208201526102ca565b34801561048257600080fd5b5061038361049136600461271f565b610ae0565b3480156104a257600080fd5b506103006104b136600461271f565b610b03565b3480156104c257600080fd5b506103006104d1366004612754565b610b5f565b610286610bc4565b3480156104ea57600080fd5b506104fe6104f9366004612789565b610bd8565b6040516102d7929190612817565b34801561051857600080fd5b5061030061052736600461283c565b610d14565b34801561053857600080fd5b5061054c610547366004612871565b610d7c565b60405190151581526020016102d7565b34801561056857600080fd5b5061054c610577366004612871565b610dc9565b34801561058857600080fd5b5061030061059736600461288c565b610e5d565b3480156105a857600080fd5b506103006105b73660046128c1565b610ec2565b3480156105c857600080fd5b507fffffffffffffffffffffffffffffffffffffffffffffffffffffffff7487392754610383565b3480156105fc57600080fd5b5061061061060b3660046128f6565b610f34565b6040516102d7919061296b565b34801561062957600080fd5b506001546103839073ffffffffffffffffffffffffffffffffffffffff1681565b34801561065657600080fd5b50610300610665366004612a2d565b611171565b610286610678366004612871565b6111a1565b61069061068b366004612a62565b6112ac565b6040516102d79190612a9d565b3480156106a957600080fd5b5061030060005481565b3480156106bf57600080fd5b506103006106ce3660046125b8565b611311565b3480156106df57600080fd5b506103006106ee366004612b12565b600360209081526000928352604080842090915290825290205481565b610286610719366004612871565b61136d565b61028661072c366004612871565b6113ad565b61069061073f3660046128f6565b6113d4565b34801561075057600080fd5b5061030061075f366004612871565b63389a75e1600c908152600091909152602090205490565b34801561078357600080fd5b50610383610792366004612a2d565b6113ea565b60006060600080845190505b808210156107fc57826107ce8684815181106107c1576107c1612b3c565b6020026020010151610ec2565b6040516020016107df929190612b6b565b60408051601f1981840301815291905292506001909101906107a3565b5050805160209091012092915050565b60006202a30067ffffffffffffffff164201905063389a75e1600c5233600052806020600c2055337fdbf36a107da19e49527a7176a1babf963b4b0ff8cde35ee35d6cd8f1f9ac7e1d600080a250565b6000805461086983611311565b6040517f19010000000000000000000000000000000000000000000000000000000000006020820152602281019290925260428201526062015b604051602081830303815290604052805190602001209050919050565b60007f8b73c3c69bb8fe3d512ecc4cf759cc79239f7b179b0ffacaa9a75d522b39400f826000015180519060200120836020015180519060200120846040015185606001516040516020016108a395949392919094855260208501939093526040840191909152606083015273ffffffffffffffffffffffffffffffffffffffff16608082015260a00190565b805160208083015160408085015180519084012081517fba015bd32610c44647c4bcbb8c645ee60d5957ae5e7aa37e56c897d9295af65a9481019490945273ffffffffffffffffffffffffffffffffffffffff909416908301526060820152608081019190915260009060a0016108a3565b80516020808301516040516000936108a3937f276c12ec467e6d60d25741105b112102c28092173b15ca9db916c654ad913d7c939192019283526020830191909152604082015260600190565b60008054610869835b60007febe783112b2088c6a788530144d3c69021fe5d4d46f650940d6bfaf88b54e3f782600001518360200151610a4f8560400151610797565b60608087015160808089015160408051602081019990995273ffffffffffffffffffffffffffffffffffffffff909716968801969096529186019390935284015260a0830152151560c082015260e0016108a3565b63389a75e1600c523360005260006020600c2055337ffa7b8eab7da67f412cc9575ed43464468f9bfbae89d1675917346ca6d8fe3c92600080a2565b6000610afd8260200151610af78460000151610a0c565b90611401565b92915050565b60007ffbb5bac87a66a98421e535854c88c14ea8206480ff93a62baef88eb379697455610b338360000151610a15565b6020808501518051908201206040516108a3949392019283526020830191909152604082015260600190565b60006060600080845190505b808210156107fc5782610b96868481518110610b8957610b89612b3c565b6020026020010151610b03565b604051602001610ba7929190612b6b565b60408051601f198184030181529190529250600190910190610b6b565b610bcc6114ab565b610bd660006114e1565b565b60408051808201909152600081526060602082018190529082516020840151855160405160009373ffffffffffffffffffffffffffffffffffffffff16927f11aecce20000000000000000000000000000000000000000000000000000000092610c46928b90602401612b8d565b60408051601f198184030181529181526020820180517bffffffffffffffffffffffffffffffffffffffffffffffffffffffff167fffffffff00000000000000000000000000000000000000000000000000000000909416939093179092529051610cb19190612bf7565b600060405180830381855afa9150503d8060008114610cec576040519150601f19603f3d011682016040523d82523d6000602084013e610cf1565b606091505b506040805180820190915291151582526020820181905297909650945050505050565b60007fd88a558de6e76ae3b06e4691e5c7eb27632ad144c564c3c807b9b011d3207c89610d44836000015161094d565b610d518460200151610b5f565b604080860151815160208101959095529084019290925260608301521515608082015260a0016108a3565b6000610d866114ab565b600460205272ffffffffffffffffffffffffffffffffffffff600883901c166000908152604090208054600160ff851681811b9092189283905591901c16610afd565b6000610df37fffffffffffffffffffffffffffffffffffffffffffffffffffffffff748739275490565b73ffffffffffffffffffffffffffffffffffffffff168273ffffffffffffffffffffffffffffffffffffffff161480610afd575072ffffffffffffffffffffffffffffffffffffff600883901c1660009081526004602052604090205460ff83161c600116610afd565b60006060600080845190505b808210156107fc5782610e94868481518110610e8757610e87612b3c565b6020026020010151610d14565b604051602001610ea5929190612b6b565b60408051601f198184030181529190529250600190910190610e69565b805160208083015180519082012060408085015181517f11d2e7ce7b01636231a80046eb2467257c3ea77c5a408e6ddd3d0899cfbc73799481019490945273ffffffffffffffffffffffffffffffffffffffff909416908301526060820152901515608082015260009060a0016108a3565b6060816000819003610f87576040805160008082526020820190925290610f7e565b604080518082019091526000815260606020820152815260200190600190039081610f565790505b50915050610afd565b60008167ffffffffffffffff811115610fa257610fa2611f82565b604051908082528060200260200182016040528015610fe857816020015b604080518082019091526000815260606020820152815260200190600190039081610fc05790505b50905060005b60ff811685111561116857600086868360ff1681811061101057611010612b3c565b90506020028101906110229190612c13565b61102b90612c47565b90508060200151516000036110405750611156565b60005b8160200151518160ff16101561115357600082602001518260ff168151811061106e5761106e612b3c565b602002602001015160000151905080604001515160000361108f5750611141565b60006110ad84602001518460ff1681518110610b8957610b89612b3c565b905060005b8260400151518160ff16101561113d576110ed828685604001518460ff16815181106110e0576110e0612b3c565b6020026020010151610bd8565b86516040018b8b6110fd81612c82565b9c508b5161110b9190612cb7565b8151811061111b5761111b612b3c565b602002602001018290528290525050808061113590612cca565b9150506110b2565b5050505b8061114b81612cca565b915050611043565b50505b8061116081612cca565b915050610fee565b50505092915050565b60007f62f30595f4177d43243112a959ea1be53d5882871b1cc6917311b8d1fe83793c610b338360000151611311565b7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffbf60113280546003825580156111f35760018160011c14303b106111ea5763f92ee8a96000526004601cfd5b818160ff1b1b91505b506111fd82611550565b61127361123a60408051808201909152600f81527f506c75675661756c74536f636b65740000000000000000000000000000000000602082015290565b60408051808201909152600581527f302e302e3000000000000000000000000000000000000000000000000000000060208201526115d2565b80156112a8576002815560016020527fc7f505b2f371ae2175ee4913f4499e1f2633a7b5936321eed1cdaeb6115181d2602080a15b5050565b606060006112bc61079284612ce9565b90506112c781611618565b6112ed816112d58580612c13565b6020018036038101906112e891906126ce565b61168c565b61130a6112fa8480612c13565b6113049080612cf5565b8361173b565b9392505050565b60007f47c7cdc8df0e6a9774c8b8955db068ee1707012a385dae083e0190f51ab2f4e56113418360000151610e5d565b61134e84602001516109bf565b60408051602081019490945283019190915260608201526080016108a3565b6113756114ab565b63389a75e1600c52806000526020600c20805442111561139d57636f5e88186000526004601cfd5b600090556113aa816114e1565b50565b6113b56114ab565b8060601b6113cb57637448fbae6000526004601cfd5b6113aa816114e1565b60606113df33611618565b61130a83833361173b565b6000610afd8260200151610af7846000015161085c565b604051600190836000526020830151604052604083510361145657604083015160ff81901c601b016020527f7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff1660605261147c565b604183510361147757606083015160001a602052604083015160605261147c565b600091505b6020600160806000855afa5191503d61149d57638baa579f6000526004601cfd5b600060605260405292915050565b7fffffffffffffffffffffffffffffffffffffffffffffffffffffffff74873927543314610bd6576382b429006000526004601cfd5b7fffffffffffffffffffffffffffffffffffffffffffffffffffffffff74873927805473ffffffffffffffffffffffffffffffffffffffff9092169182907f8be0079c531659141344cd1fd0a4f28419497f9722a3daafe3b4186f6b6457e0600080a3811560ff1b8217905550565b7fffffffffffffffffffffffffffffffffffffffffffffffffffffffff7487392780541561158657630dc149f06000526004601cfd5b73ffffffffffffffffffffffffffffffffffffffff909116801560ff1b81179091558060007f8be0079c531659141344cd1fd0a4f28419497f9722a3daafe3b4186f6b6457e08180a350565b61161160405180608001604052808481526020018381526020014681526020013073ffffffffffffffffffffffffffffffffffffffff168152506108c0565b6000555050565b61162181610dc9565b6113aa576040517f08c379a000000000000000000000000000000000000000000000000000000000815260206004820152601a60248201527f506c75675369676e6572733a7369676e65722d696e76616c696400000000000060448201526064015b60405180910390fd5b73ffffffffffffffffffffffffffffffffffffffff82166000908152600360209081526040808320848301518452909152812080549091906116cd90612d64565b91829055508151146112a8576040517f08c379a000000000000000000000000000000000000000000000000000000000815260206004820152601c60248201527f506c7567436f72653a6e6f6e6365322d6f75742d6f662d6f72646572000000006044820152606401611683565b60608267ffffffffffffffff81111561175657611756611f82565b60405190808252806020026020018201604052801561178957816020015b60608152602001906001900390816117745790505b50905060008060008060006117ca6040805160c081018252600060608083018281526080840183905260a08401829052835260208301529181019190915290565b6040805160e08101825260008183018181526060808401839052608080850182905260a080860185905260c086018590529285526020808601839052865193840187528484528301849052948201819052810182905292830152905b8a881015611bdb578b8b8981811061184057611840612b3c565b90506020028101906118529190612c13565b61185b90612c47565b6020810151516000955090935084036118c3576002805473ffffffffffffffffffffffffffffffffffffffff8c167fffffffffffffffffffffffff00000000000000000000000000000000000000009182168117909255600180549091169091179055611ad8565b600096505b826020015151871015611ad857826020015187815181106118eb576118eb612b3c565b602002602001015191506118fe82610ae0565b945086600003611959576002805473ffffffffffffffffffffffffffffffffffffffff87167fffffffffffffffffffffffff000000000000000000000000000000000000000091821681179092556001805490911690911790555b60015473ffffffffffffffffffffffffffffffffffffffff8681169116146119dd576040517f08c379a000000000000000000000000000000000000000000000000000000000815260206004820152601b60248201527f506c7567436f72653a696e76616c69642d70696e2d7369676e657200000000006044820152606401611683565b50805160208101518414611a73576040517f08c379a000000000000000000000000000000000000000000000000000000000815260206004820152602360248201527f506c7567436f72653a696e76616c69642d617574686f726974792d70696e2d6c60448201527f696e6b00000000000000000000000000000000000000000000000000000000006064820152608401611683565b611a7c82610b03565b9350600095505b806040015151861015611acd57611abc81604001518781518110611aa957611aa9612b3c565b6020026020010151846000015186611bea565b835160400152600190950194611a83565b6001909601956118c8565b60015473ffffffffffffffffffffffffffffffffffffffff8b8116911614611b5c576040517f08c379a000000000000000000000000000000000000000000000000000000000815260206004820152601760248201527f506c7567436f72653a696e76616c69642d73656e6465720000000000000000006044820152606401611683565b8251600254611b81919073ffffffffffffffffffffffffffffffffffffffff16611d16565b898981518110611b9357611b93612b3c565b6020908102919091010152600180547fffffffffffffffffffffffff000000000000000000000000000000000000000090811682556002805490911690559790970196611826565b50505050505050509392505050565b60606000846000015173ffffffffffffffffffffffffffffffffffffffff166311aecce260e01b86602001518686604051602401611c2a93929190612b8d565b60408051601f198184030181529181526020820180517bffffffffffffffffffffffffffffffffffffffffffffffffffffffff167fffffffff00000000000000000000000000000000000000000000000000000000909416939093179092529051611c959190612bf7565b6000604051808303816000865af19150503d8060008114611cd2576040519150601f19603f3d011682016040523d82523d6000602084013e611cd7565b606091505b509250905080158015611ceb575084604001515b15611cf957611cf982611dd1565b81806020019051810190611d0d9190612d9c565b95945050505050565b60606000836040015183604051602001611d31929190612e0a565b60405160208183030381529060405290506000846000015173ffffffffffffffffffffffffffffffffffffffff165a866020015184604051611d739190612bf7565b600060405180830381858888f193505050503d8060008114611db1576040519150601f19603f3d011682016040523d82523d6000602084013e611db6565b606091505b509350905080611dc957611dc983611dd1565b505092915050565b600481511015611e3d576040517f08c379a000000000000000000000000000000000000000000000000000000000815260206004820152600f60248201527f506c7567436f72653a72657665727400000000000000000000000000000000006044820152606401611683565b60208101517fb1b7848f000000000000000000000000000000000000000000000000000000007fffffffff00000000000000000000000000000000000000000000000000000000821601611f1657604080518082018252601b81527f506c7567436f72653a7461726765742d70616e69636b65642d30780000000000602082018181526024860151600481811c600f908116603090810160081b918416011790931790915292517f08c379a000000000000000000000000000000000000000000000000000000000815291929161168391849101611f6f565b81518060208401fd5b60005b83811015611f3a578181015183820152602001611f22565b50506000910152565b60008151808452611f5b816020860160208601611f1f565b601f01601f19169290920160200192915050565b60208152600061130a6020830184611f43565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052604160045260246000fd5b6040516060810167ffffffffffffffff81118282101715611fd457611fd4611f82565b60405290565b6040805190810167ffffffffffffffff81118282101715611fd457611fd4611f82565b6040516080810167ffffffffffffffff81118282101715611fd457611fd4611f82565b604051601f8201601f1916810167ffffffffffffffff8111828210171561204957612049611f82565b604052919050565b600067ffffffffffffffff82111561206b5761206b611f82565b5060051b60200190565b803573ffffffffffffffffffffffffffffffffffffffff8116811461209957600080fd5b919050565b600067ffffffffffffffff8211156120b8576120b8611f82565b50601f01601f191660200190565b600082601f8301126120d757600080fd5b81356120ea6120e58261209e565b612020565b8181528460208386010111156120ff57600080fd5b816020850160208301376000918101602001919091529392505050565b8035801515811461209957600080fd5b60006060828403121561213e57600080fd5b612146611fb1565b905061215182612075565b8152602082013567ffffffffffffffff81111561216d57600080fd5b612179848285016120c6565b60208301525061218b6040830161211c565b604082015292915050565b600082601f8301126121a757600080fd5b813560206121b76120e583612051565b82815260059290921b840181019181810190868411156121d657600080fd5b8286015b8481101561221657803567ffffffffffffffff8111156121fa5760008081fd5b6122088986838b010161212c565b8452509183019183016121da565b509695505050505050565b60006020828403121561223357600080fd5b813567ffffffffffffffff81111561224a57600080fd5b61225684828501612196565b949350505050565b60006060828403121561227057600080fd5b612278611fb1565b905061228382612075565b815260208201356020820152604082013567ffffffffffffffff8111156122a957600080fd5b6122b5848285016120c6565b60408301525092915050565b600060a082840312156122d357600080fd5b60405160a0810167ffffffffffffffff82821081831117156122f7576122f7611f82565b8160405282935061230785612075565b835260208501356020840152604085013591508082111561232757600080fd5b5061233485828601612196565b604083015250606083013560608201526123506080840161211c565b60808201525092915050565b60006040828403121561236e57600080fd5b612376611fda565b9050813567ffffffffffffffff8082111561239057600080fd5b61239c858386016122c1565b835260208401359150808211156123b257600080fd5b506123bf848285016120c6565b60208301525092915050565b600082601f8301126123dc57600080fd5b813560206123ec6120e583612051565b82815260059290921b8401810191818101908684111561240b57600080fd5b8286015b8481101561221657803567ffffffffffffffff81111561242f5760008081fd5b61243d8986838b010161235c565b84525091830191830161240f565b60006060828403121561245d57600080fd5b612465611fb1565b9050813567ffffffffffffffff8082111561247f57600080fd5b61248b8583860161225e565b835260208401359150808211156124a157600080fd5b50612179848285016123cb565b600082601f8301126124bf57600080fd5b813560206124cf6120e583612051565b82815260059290921b840181019181810190868411156124ee57600080fd5b8286015b8481101561221657803567ffffffffffffffff8111156125125760008081fd5b6125208986838b010161244b565b8452509183019183016124f2565b60006040828403121561254057600080fd5b612548611fda565b9050813581526020820135602082015292915050565b60006060828403121561257057600080fd5b612578611fda565b9050813567ffffffffffffffff81111561259157600080fd5b61259d848285016124ae565b8252506125ad836020840161252e565b602082015292915050565b6000602082840312156125ca57600080fd5b813567ffffffffffffffff8111156125e157600080fd5b6122568482850161255e565b6000602082840312156125ff57600080fd5b813567ffffffffffffffff8082111561261757600080fd5b908301906080828603121561262b57600080fd5b612633611ffd565b82358281111561264257600080fd5b61264e878286016120c6565b82525060208301358281111561266357600080fd5b61266f878286016120c6565b6020830152506040830135604082015261268b60608401612075565b606082015295945050505050565b6000602082840312156126ab57600080fd5b813567ffffffffffffffff8111156126c257600080fd5b6122568482850161225e565b6000604082840312156126e057600080fd5b61130a838361252e565b6000602082840312156126fc57600080fd5b813567ffffffffffffffff81111561271357600080fd5b612256848285016122c1565b60006020828403121561273157600080fd5b813567ffffffffffffffff81111561274857600080fd5b6122568482850161235c565b60006020828403121561276657600080fd5b813567ffffffffffffffff81111561277d57600080fd5b612256848285016123cb565b60008060006060848603121561279e57600080fd5b83359250602084013567ffffffffffffffff808211156127bd57600080fd5b6127c98783880161244b565b935060408601359150808211156127df57600080fd5b506127ec8682870161212c565b9150509250925092565b80511515825260006020820151604060208501526122566040850182611f43565b60408152600061282a6040830185611f43565b8281036020840152611d0d81856127f6565b60006020828403121561284e57600080fd5b813567ffffffffffffffff81111561286557600080fd5b6122568482850161244b565b60006020828403121561288357600080fd5b61130a82612075565b60006020828403121561289e57600080fd5b813567ffffffffffffffff8111156128b557600080fd5b612256848285016124ae565b6000602082840312156128d357600080fd5b813567ffffffffffffffff8111156128ea57600080fd5b6122568482850161212c565b6000806020838503121561290957600080fd5b823567ffffffffffffffff8082111561292157600080fd5b818501915085601f83011261293557600080fd5b81358181111561294457600080fd5b8660208260051b850101111561295957600080fd5b60209290920196919550909350505050565b600060208083016020845280855180835260408601915060408160051b87010192506020870160005b828110156129e0577fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffc08886030184526129ce8583516127f6565b94509285019290850190600101612994565b5092979650505050505050565b6000604082840312156129ff57600080fd5b612a07611fda565b9050813567ffffffffffffffff80821115612a2157600080fd5b61239c8583860161255e565b600060208284031215612a3f57600080fd5b813567ffffffffffffffff811115612a5657600080fd5b612256848285016129ed565b600060208284031215612a7457600080fd5b813567ffffffffffffffff811115612a8b57600080fd5b82016040818503121561130a57600080fd5b600060208083016020845280855180835260408601915060408160051b87010192506020870160005b828110156129e0577fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffc0888603018452612b00858351611f43565b94509285019290850190600101612ac6565b60008060408385031215612b2557600080fd5b612b2e83612075565b946020939093013593505050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052603260045260246000fd5b60008351612b7d818460208801611f1f565b9190910191825250602001919050565b606081526000612ba06060830186611f43565b828103602084015273ffffffffffffffffffffffffffffffffffffffff855116815260208501516020820152604085015160606040830152612be56060830182611f43565b92505050826040830152949350505050565b60008251612c09818460208701611f1f565b9190910192915050565b600082357fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffa1833603018112612c0957600080fd5b6000610afd368361244b565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052601160045260246000fd5b600081612c9157612c91612c53565b507fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0190565b81810381811115610afd57610afd612c53565b600060ff821660ff8103612ce057612ce0612c53565b60010192915050565b6000610afd36836129ed565b60008083357fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffe1843603018112612d2a57600080fd5b83018035915067ffffffffffffffff821115612d4557600080fd5b6020019150600581901b3603821315612d5d57600080fd5b9250929050565b60007fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff8203612d9557612d95612c53565b5060010190565b600060208284031215612dae57600080fd5b815167ffffffffffffffff811115612dc557600080fd5b8201601f81018413612dd657600080fd5b8051612de46120e58261209e565b818152856020838501011115612df957600080fd5b611d0d826020830160208601611f1f565b60008351612e1c818460208801611f1f565b60609390931b7fffffffffffffffffffffffffffffffffffffffff00000000000000000000000016919092019081526014019291505056fea164736f6c6343000817000a";

    bytes32 internal constant VAULT_SOCKET_SALT = 0x0;

    address internal constant VAULT_SOCKET_ADDRESS = address(0);

    /**
     * @notice Deploy (if needed) and return the PlugRouterSocket contract instance.
     * @return $routerSocket The PlugRouterSocket contract instance.
     */
    function routerSocket() internal returns (PlugRouterSocket $routerSocket) {
        if (_extcodesize(ROUTER_SOCKET_ADDRESS) == 0) {
            address reality =
                _safeCreate2(ROUTER_SOCKET_SALT, ROUTER_SOCKET_INITCODE);
            require(
                reality == ROUTER_SOCKET_ADDRESS, "Etcher: Reality check failed"
            );
        }
        $routerSocket = PlugRouterSocket(payable(ROUTER_SOCKET_ADDRESS));
    }

    /**
     * @notice Deploy (if needed) and return the PlugVaultSocket contract instance.
     * @return $vaultSocket The PlugVaultSocket contract instance.
     */
    function vaultSocket() internal returns (PlugVaultSocket $vaultSocket) {
        if (_extcodesize(VAULT_SOCKET_ADDRESS) == 0) {
            address reality =
                _safeCreate2(VAULT_SOCKET_SALT, VAULT_SOCKET_INITCODE);
            require(
                reality == VAULT_SOCKET_ADDRESS, "Etcher: Reality check failed"
            );
        }
        $vaultSocket = PlugVaultSocket(payable(VAULT_SOCKET_ADDRESS));
    }

    /**
     * @notice Deploys a contract via 0age's immutable create 2 factory for testing.
     * @param $salt The salt to use for the deployment.
     * @param $initializationCode The initialization code for the contract.
     * @return $deployment The address of the deployed contract.
     */
    function _safeCreate2(
        bytes32 $salt,
        bytes memory $initializationCode
    )
        private
        returns (address $deployment)
    {
        // Canonical address of 0age's immutable create 2 factory.
        address c2f = 0x0000000000FFe8B47B3e2130213B802212439497;
        if (_extcodesize(c2f) == 0) {
            bytes memory ic2fBytecode =
                hex"60806040526004361061003f5760003560e01c806308508b8f1461004457806364e030871461009857806385cf97ab14610138578063a49a7c90146101bc575b600080fd5b34801561005057600080fd5b506100846004803603602081101561006757600080fd5b503573ffffffffffffffffffffffffffffffffffffffff166101ec565b604080519115158252519081900360200190f35b61010f600480360360408110156100ae57600080fd5b813591908101906040810160208201356401000000008111156100d057600080fd5b8201836020820111156100e257600080fd5b8035906020019184600183028401116401000000008311171561010457600080fd5b509092509050610217565b6040805173ffffffffffffffffffffffffffffffffffffffff9092168252519081900360200190f35b34801561014457600080fd5b5061010f6004803603604081101561015b57600080fd5b8135919081019060408101602082013564010000000081111561017d57600080fd5b82018360208201111561018f57600080fd5b803590602001918460018302840111640100000000831117156101b157600080fd5b509092509050610592565b3480156101c857600080fd5b5061010f600480360360408110156101df57600080fd5b508035906020013561069e565b73ffffffffffffffffffffffffffffffffffffffff1660009081526020819052604090205460ff1690565b600083606081901c33148061024c57507fffffffffffffffffffffffffffffffffffffffff0000000000000000000000008116155b6102a1576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260458152602001806107746045913960600191505060405180910390fd5b606084848080601f0160208091040260200160405190810160405280939291908181526020018383808284376000920182905250604051855195965090943094508b93508692506020918201918291908401908083835b6020831061033557805182527fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffe090920191602091820191016102f8565b51815160209384036101000a7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff018019909216911617905260408051929094018281037fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffe00183528085528251928201929092207fff000000000000000000000000000000000000000000000000000000000000008383015260609890981b7fffffffffffffffffffffffffffffffffffffffff00000000000000000000000016602183015260358201969096526055808201979097528251808203909701875260750182525084519484019490942073ffffffffffffffffffffffffffffffffffffffff81166000908152938490529390922054929350505060ff16156104a7576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040180806020018281038252603f815260200180610735603f913960400191505060405180910390fd5b81602001825188818334f5955050508073ffffffffffffffffffffffffffffffffffffffff168473ffffffffffffffffffffffffffffffffffffffff161461053a576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260468152602001806107b96046913960600191505060405180910390fd5b50505073ffffffffffffffffffffffffffffffffffffffff8116600090815260208190526040902080547fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff001660011790559392505050565b6000308484846040516020018083838082843760408051919093018181037fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffe001825280845281516020928301207fff000000000000000000000000000000000000000000000000000000000000008383015260609990991b7fffffffffffffffffffffffffffffffffffffffff000000000000000000000000166021820152603581019790975260558088019890985282518088039098018852607590960182525085519585019590952073ffffffffffffffffffffffffffffffffffffffff81166000908152948590529490932054939450505060ff909116159050610697575060005b9392505050565b604080517fff000000000000000000000000000000000000000000000000000000000000006020808301919091523060601b6021830152603582018590526055808301859052835180840390910181526075909201835281519181019190912073ffffffffffffffffffffffffffffffffffffffff81166000908152918290529190205460ff161561072e575060005b9291505056fe496e76616c696420636f6e7472616374206372656174696f6e202d20636f6e74726163742068617320616c7265616479206265656e206465706c6f7965642e496e76616c69642073616c74202d206669727374203230206279746573206f66207468652073616c74206d757374206d617463682063616c6c696e6720616464726573732e4661696c656420746f206465706c6f7920636f6e7472616374207573696e672070726f76696465642073616c7420616e6420696e697469616c697a6174696f6e20636f64652ea265627a7a723058202bdc55310d97c4088f18acf04253db593f0914059f0c781a9df3624dcef0d1cf64736f6c634300050a0032";
            /// @solidity memory-safe-assembly
            assembly {
                let m := mload(0x40)
                mstore(m, 0xb4d6c782) // `etch(address,bytes)`.
                mstore(add(m, 0x20), c2f)
                mstore(add(m, 0x40), 0x40)
                let n := mload(ic2fBytecode)
                mstore(add(m, 0x60), n)
                for { let i := 0 } lt(i, n) { i := add(0x20, i) } {
                    mstore(
                        add(add(m, 0x80), i),
                        mload(add(add(ic2fBytecode, 0x20), i))
                    )
                }
                let vmAddress := 0x7109709ECfa91a80626fF3989D68f67F5b1DD12D
                if iszero(
                    call(
                        gas(),
                        vmAddress,
                        0,
                        add(m, 0x1c),
                        add(n, 0x64),
                        0x00,
                        0x00
                    )
                ) { revert(0, 0) }
            }
        }
        /// @solidity memory-safe-assembly
        assembly {
            let m := mload(0x40)
            let n := mload($initializationCode)
            mstore(m, 0x64e03087) // `safeCreate2(bytes32,bytes)`.
            mstore(add(m, 0x20), $salt)
            mstore(add(m, 0x40), 0x40)
            mstore(add(m, 0x60), n)
            // prettier-ignore
            for { let i := 0 } lt(i, n) { i := add(i, 0x20) } {
                mstore(
                    add(add(m, 0x80), i),
                    mload(add(add($initializationCode, 0x20), i))
                )
            }
            if iszero(call(gas(), c2f, 0, add(m, 0x1c), add(n, 0x64), m, 0x20))
            {
                returndatacopy(m, m, returndatasize())
                revert(m, returndatasize())
            }
            $deployment := mload(m)
        }
    }

    /**
     * @notice Determine and retrieve the extcodesize of `deployment`.
     * @param $deployment The address to check.
     * @return $result The size of the code at `deployment`.
     */
    function _extcodesize(address $deployment)
        private
        view
        returns (uint256 $result)
    {
        /// @solidity memory-safe-assembly
        assembly {
            $result := extcodesize($deployment)
        }
    }
}
